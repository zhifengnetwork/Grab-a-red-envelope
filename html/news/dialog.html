<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0,user-scalable=no" />    
	<script src="../../js/public/rem.js"></script>    
    <link rel="stylesheet" href="../../css/public/public.css">
    <link rel="stylesheet" href="../../css/public/public_head.css">
    <link rel="stylesheet" href="../../css/news/dialog.css">
    <title>对话框</title>
</head>

<body style="overflow-y: scroll">
    <div class="wrap_frame">
        <!--public head-->
        <div class="lb_headWrap">
            <p class="lb_headWrap_return" data-num="1" onclick="returnFun()">
                <img class="lb_headWrap_return_img" src="../../img/public/left.png"/>
            </p>
            <p class="lb_headWrap_dialog">
                <span class="lb_headWrap_dialog_text">99+</span>
            </p>
            <span>神秘电波</span>
            <p class="lb_headWrap_remove">
                <img class="lb_headWrap_remove_img" src="../../img/news/remove.png">
            </p>
        </div>
        <!-- 聊天内容 -->
        <div class="dialog_content">
            <div class="dialog_content_time">
                昨天 22:22
            </div>
            <!-- 对方消息 -->
            <div class="dialog_content_opposite clearfloat">
                <div class="dialog_content_opposite_imgwrap">
                    <img class="dialog_content_opposite_img" src="../../img/0000⑨.jpg" alt="">
                </div>
                <div class="dialog_content_opposite_info">
                    <div class="dialog_content_opposite_name">神秘电波</div>
                    <div class="dialog_content_opposite_text">66666666</div>
                </div>
            </div>
            <!-- 本人消息 -->
            <div class="dialog_content_oneself clearfloat">
                <div class="dialog_content_oneself_imgwrap">
                    <img class="dialog_content_oneself_img" src="../../img/0000⑨.jpg" alt="">
                </div>
                <div class="dialog_content_oneself_info">
                    <div class="dialog_content_oneself_name">质检员</div>
                    <div class="dialog_content_oneself_text">66666666</div>
                </div>
            </div>
            <!-- 本人转账 -->
            <div class="dialog_content_oneself clearfloat">
                <div class="dialog_content_oneself_imgwrap">
                    <img class="dialog_content_oneself_img" src="../../img/0000⑨.jpg" alt="">
                </div>
                <div class="dialog_content_oneself_info">
                    <p class="dialog_content_oneself_name">质检员</p>
                    <div class="dialog_content_oneself_transfer">
                        <div class="oneself_transfer_info">
                            <div class="oneself_transfer_imgwrap">
                                <img class="oneself_transfer_img" src="../../img/news/transfer2.png" alt="">
                            </div>
                            <div class="oneself_transfer_price">
                                <div>给神秘电波转账</div>
                                <div>￥999.00</div>
                            </div>
                        </div>
                        <p class="oneself_transfer_text">转帐</p>
                    </div>
                </div>
            </div>
            <!-- 对方转账 -->
            <div class="dialog_content_opposite clearfloat">
                <div class="dialog_content_opposite_imgwrap">
                    <img class="dialog_content_opposite_img" src="../../img/0000⑨.jpg" alt="">
                </div>
                <div class="dialog_content_opposite_info">
                    <p class="dialog_content_opposite_name">神秘电波</p>
                    <div class="dialog_content_opposite_transfer">
                        <div class="opposite_transfer_info">
                            <div class="opposite_transfer_imgwrap">
                                <img class="opposite_transfer_img" src="../../img/news/transfer2.png" alt="">
                            </div>
                            <div class="opposite_transfer_price">
                                <div>给质检员转账</div>
                                <div>￥999.00</div>
                            </div>
                        </div>
                        <p class="opposite_transfer_text">转帐</p>
                    </div>
                </div>
            </div>
            <!-- 本人收款 -->
            <div class="dialog_content_oneself clearfloat">
                <div class="dialog_content_oneself_imgwrap">
                    <img class="dialog_content_oneself_img" src="../../img/0000⑨.jpg" alt="">
                </div>
                <div class="dialog_content_oneself_info">
                    <p class="dialog_content_oneself_name">质检员</p>
                    <div class="dialog_content_oneself_transfer gathering">
                        <div class="oneself_transfer_info">
                            <div class="oneself_transfer_imgwrap">
                                <img class="oneself_transfer_img" src="../../img/news/succeed.png" alt="">
                            </div>
                            <div class="oneself_transfer_price">
                                <div>已收款</div>
                                <div>￥999.00</div>
                            </div>
                        </div>
                        <p class="oneself_transfer_text">收款</p>
                    </div>
                </div>
            </div>
            <!-- 对方收款 -->
            <div class="dialog_content_opposite clearfloat">
                <div class="dialog_content_opposite_imgwrap">
                    <img class="dialog_content_opposite_img" src="../../img/0000⑨.jpg" alt="">
                </div>
                <div class="dialog_content_opposite_info">
                    <p class="dialog_content_opposite_name">神秘电波</p>
                    <div class="dialog_content_oneself_transfer gathering">
                        <div class="opposite_transfer_info">
                            <div class="opposite_transfer_imgwrap">
                                <img class="opposite_transfer_img" src="../../img/news/succeed.png" alt="">
                            </div>
                            <div class="opposite_transfer_price">
                                <div>神秘电波已收款</div>
                                <div>￥999.00</div>
                            </div>
                        </div>
                        <p class="opposite_transfer_text">收款</p>
                    </div>
                </div>
            </div>
        </div>
        <!-- 转账 -->
        <div class="dialog_transfer_wrap">
            <div class="dialog_transfer">
                <!-- 头部返回菜单 -->
                <div class="dialog_transfer_back">
                    <p class="dialog_transfer_back_title">
                        <img class="dialog_transfer_back_img" src="../../img/public/left.png" alt="">
                        <span>转账</span>
                    </p>
                </div>
                <!-- 被转账用户 -->
                <div class="dialog_transfer_user">
                    <img class="dialog_transfer_user_img" src="../../img/0000⑨.jpg" alt="">
                    <div class="dialog_transfer_user_name">
                        神秘电波(10259)
                    </div>
                </div>
                <!-- 转账金额 -->
                <div class="dialog_transfer_num">
                    <div class="dialog_transfer_num_title">
                        请输入金额
                    </div>
                    <label class="dialog_transfer_num_label">￥
                        <input class="dialog_transfer_num_input" type="number">
                    </label>
                </div>
                <!-- 确认转账 -->
                <div class="dialog_transfer_affirm">
                    确认转账
                </div>
            </div>
        </div>
        <!-- 底部菜单 -->
        <div class="dialog_menu">
            <div class="dialog_menu_inputwrap clearfloat">
                <div class="dialog_menu_voice">
                    <img class="dialog_menu_img" src="../../img/news/voice.png" alt="">
                </div>
                <label class="dialog_menu_label">
                    <div class="dialog_menu_input" contenteditable="true"></div>
                </label>
                <span class="dialog_menu_send">发送</span>
            </div>
            <div class="dialog_menu_submenu">
                <!-- 相机 -->
                <p class="dialog_menu_submenu_item">
                    <img class="dialog_menu_submenu_img" src="../../img/news/camera.png" alt="">
                    <input type="file" class='camera' accept="image/*" capture='camera'>
                </p>    
                <!-- 照片 -->
                <p class="dialog_menu_submenu_item">
                    <img class="dialog_menu_submenu_img" src="../../img/news/picture.png" alt="">
                    <input type="file" class="picture">
                </p>
                <!-- 转账 -->
                <p class="dialog_menu_submenu_item transfer">
                    <img class="dialog_menu_submenu_img" src="../../img/news/transfer.png" alt="">
                </p>
                <!-- 转账记录 -->
                <p class="dialog_menu_submenu_item" onclick="window.location.href='transfer.html'">
                    <img class="dialog_menu_submenu_img" src="../../img/news/transfer1.png" alt="">
                </p>
                <!-- 表情 -->
                <p class="dialog_menu_submenu_item">
                    <img class="dialog_menu_submenu_img" src="../../img/news/smile.png" alt="">
                </p>
            </div>
        </div>

        <!--(数字-键盘)底部弹窗（蒙版）body-->
        <div class="bottom_alert_wrap">
            <div class="mask_text">
                <div class="red_envelope">
                    输入密码
                    <p class="delete_img_box">
                        <img class="delete_img" src="../../img/news/delete_icon.png" alt="" />
                    </p>
                    
                </div>
                <p class="red_envelope_money">￥<span>50.00</span></p>
                <div class="ds">
                    <div class="ds_ds">
                        <div class="dsds_item">
                            <p class="dsds_item_icon_box">
                                <img src="../../img/news/qian.png" class="tixian_pic" />
                            </p>
                            <span class="qunliao_item_text">账号余额(608元)</span>
                        </div>
                    </div>
                </div>
                <div class="password_box">
                    <p class="password_box_num"><span class="trem_box">·</span></p>
                    <p class="password_box_num"><span class="trem_box">·</span></p>
                    <p class="password_box_num"><span class="trem_box">·</span></p>
                    <p class="password_box_num"><span class="trem_box">·</span></p>
                    <p class="password_box_num"><span class="trem_box">·</span></p>
                    <p class="password_box_num"><span class="trem_box">·</span></p>
                </div>
            </div>
            
            
            <!--输入完密码 => 遮罩层-->
            <div class="loading_wrap"><!--报错 标签-->
                
                输入的密码错误
                
                
            </div>
            
            <!--底部弹窗（框）-->
            <div class="bottom_alert_box">
                <!--数字键盘-->
                <div class="digital_keyboard_box">
                    <!--data-num:下标-->
                    <p class="number_trem digital_key" data_state="true">1</p>
                    <p class="number_trem digital_key" data_state="true">2</p>
                    <p class="number_trem digital_key" data_state="true">3</p>
                    <p class="number_trem digital_key" data_state="true">4</p>
                    <p class="number_trem digital_key" data_state="true">5</p>
                    <p class="number_trem digital_key" data_state="true">6</p>
                    <p class="number_trem digital_key" data_state="true">7</p>
                    <p class="number_trem digital_key" data_state="true">8</p>
                    <p class="number_trem digital_key" data_state="true">9</p>
                    <!--最后三个无bottom边框-->
                    <p class="number_trem number_trem_none"></p>
                    <p class="number_trem number_trem_none digital_key" data_state="true">0</p>
                    <div class="number_trem number_trem_none">
                        <i class="eliminate_cion"></i>
                        <!--删除按钮-->
                        <p class="delete_box digital_key" data-state="delete"></p>
                    </div>
                </div>
            </div>

        </div>

    </div>
    <script src="../../js/public/jquery-1.8.3.js"></script>
    <script src="../../js/public/public.js"></script>
    <script src="../../js/news/dialog.js"></script>
    <script>
			$(function() {
				/**
				 * 全局变量
				 * **/
				/*存储-当前滚动条的位置*/
				var thisScroll_num = null;
				/*获取支付密码（后台*/
				var pass_val = '';
				$('.digital_key').on('click',function(){
					/*触摸-添加样式*/
					$(this).addClass('number_trem_active');
					/*当前的元素*/
			    	var this_eve = $(this);
			    	/*当前的数字*/
			    	var this_nun = Number(this_eve.html());
			    	/*当前-状态(输入数字true，删除false)*/
			    	var this_state = true;
			    	/*删除-按钮*/
			        if(this_eve.attr('data-state') == 'delete'){
			        	/*如果当元素为空时*/
			        	if(pass_val == ""){
			        		console.log('密码为空!');
			        		remove_class($(this));
			        		return false;
			        	}
			        	/*删除最后一个元素*/
	        			arr_str = pass_val.split('');
	        			/*数组删除最后一项*/
	        			arr_str.pop();
	        			pass_val = arr_str.join('');
//	        			if(pass_val.length){
        				console.log('模拟删除代码',pass_val.length);
        				/*页面-模拟删除代码*/
        				if(pass_val.length > 0){
        					$('.password_box_num .trem_box').eq(pass_val.length).removeClass("show_box");
        				}else {
        					$('.password_box_num .trem_box').eq(0).removeClass("show_box");
        				}
	        			this_state = false;
	        		}
	            	/*获取支付密码*/
	            	if(pass_val.length < 6 && this_state){
	            		pass_val += this_nun;
	            	}
	            	/*状态*/
	            	if(this_state){
	            		/*页面-模拟密码-代码*/
	        			$('.password_box_num .trem_box').eq(pass_val.length-1).addClass("show_box");
	            	}
	            	console.log(pass_val);
	        		/*密码长度为6时，ajax*/
	            	if(pass_val.length == 6){
	            		remove_class($(this));
	            		$('.loading_wrap').show();
	            		$('.mask_text').hide();
	            		$('.bottom_alert_box').hide();
	            		console.log('ajax-最终密码:',pass_val);
	            		setTimeout(function(){
	            			$('.loading_wrap').hide();
	            		    $('.mask_text').show();
	            		    $('.bottom_alert_box').show();
	            		    pass_val='';
	            		    $('.trem_box').removeClass('show_box')
	            		},1100);
	            		return false;
	            	}
	            	remove_class($(this));
				})
				/*离开-删除样式*/
				function remove_class(_this){
					/*模拟-touchs事件，因为iso上失效*/
					setTimeout(function(){
						_this.removeClass('number_trem_active');
					},100);
					
				}
				
				/*点击出现-底部弹窗*/
				$('.dialog_transfer_affirm').on('click',function(){
					$('.bottom_alert_wrap').show();
					/*底部弹窗(出现)*/
					$('.bottom_alert_box').animate({'bottom':'0'});
					/*获取当前滚动条的位置*/
					thisScroll_num = $(document).scrollTop();
					console.log('获取当前滚动条的位置',thisScroll_num);
					/**禁止底部滑动
					 * 设置为fixed之后会飘到顶部，所以要动态计算当前用户所在高度
					 **/
					$('.wrap').css({
						'position':'fixed',
						'top': -thisScroll_num,
						'left': 0,
					});
				})
				/*关闭遮罩层*/
				$('.delete_img_box').on('click',function(){
					 $('.bottom_alert_wrap').hide();
					 pass_val='';
	                 $('.trem_box').removeClass('show_box');
					/*底部弹窗(隐藏)*/
					$('.bottom_alert_box').animate({'bottom':-($('.bottom_alert_box').height())});
					/*恢复底部滑动*/
					$('.wrap').css({
						'position':'',
						'top': '',
						'left': '',
					});
					console.log(66666,thisScroll_num);
					/*恢复当前用户滚动的位置！*/
					$(document).scrollTop(thisScroll_num);
					
				})
			});
		</script>
</body>
</html>